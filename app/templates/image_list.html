<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Image List</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/image.css') }}">
</head>
<body>
<div class="container">
    <form id="delete-form" method="POST" action="{{ url_for('image.delete_images') }}">
        <input type="hidden" name="page" value="{{ page }}">
        <div class="image-container">
            {% for image in images %}
                <div class="image-item" id="{{ image }}">
                    <img class="thumbnail" src="{{ url_for('static', filename='no-image.png') }}" data-src="{{ url_for('image.get_image', filename=image) }}" alt="{{ image }}" onclick="moveImage('{{ image }}')" >
                    <input type="hidden" name="images[]" value="{{ image }}">
                </div>
            {% endfor %}
        </div>
        <div class="pagination">
            {% if page > 1 %}
                <a href="{{ url_for('image.image_list', page=page-1) }}">&lt;</a>
            {% endif %}
            {% for p in range(max(1, page - 2), min(total_pages, page + 2) + 1) %}
                <a href="{{ url_for('image.image_list', page=p) }}" class="{{ 'active' if p == page else '' }}">{{ p }}</a>
            {% endfor %}
            {% if page < total_pages %}
                <a href="{{ url_for('image.image_list', page=page+1) }}">&gt;</a>
            {% endif %}
        </div>
        <button type="submit" class="delete-button">Delete</button>
    </form>
</div>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        const images = document.querySelectorAll('.thumbnail');
        images.forEach(img => {
            const tempSrc = img.getAttribute('data-src');
            img.src = tempSrc;
        });
    });

    function moveImage(filename) {
        fetch(`/move_image/${filename}`, { method: 'POST' })
            .then(response => response.json())
            .then(data => {
                if (data.status === 'success') {
                    document.getElementById(filename).remove();
                }
            });
    }
</script>
</body>
</html>
